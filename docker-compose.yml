services:
  redis:
    image: redis:latest

  website:
    build:
      context: .
      dockerfile: ./Dockerfile

    environment:
      NODE_ENV: production
      TITLE: ${TITLE}
      REDIS_URL: redis://redis:6379
      REDIS_CACHE_TTL_SECONDS: ${REDIS_CACHE_TTL_SECONDS:-300}
      REDIS_CACHE_TTL_SEARCH_SECONDS: ${REDIS_CACHE_TTL_SEARCH_SECONDS:-300}
      REDIS_CACHE_TTL_TRACK_SECONDS: ${REDIS_CACHE_TTL_TRACK_SECONDS:-120}
      REDIS_CACHE_MAX_BODY_BYTES: ${REDIS_CACHE_MAX_BODY_BYTES:-200000}
      PORT: 5000

    ports: ["5000:5000"]
    depends_on:
      redis:
        condition: service_started
